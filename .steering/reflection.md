# Reflection - リポジトリセットアップ (2026-02-01)

## 概要

`.steering/20260201-repository-setup` のタスクを実行し、モノレポ基盤を構築した。

---

## 学び

### 1. 公式ツールを優先する

**状況**: フロントエンドのディレクトリ構造を手動で作成しようとした。

**ユーザーからのフィードバック**:
> 「今あなたはフロントエンドのディレクトリをマニュアルで作成しようとしていましたがなぜNext.jsのセットアップコマンドを使用しないのでしょうか」

**学び**:
- フレームワークには公式のセットアップコマンドが存在する
- 手動作成よりも `create-next-app` 等の公式ツールを使うべき
- 公式ツールは最新のベストプラクティスを反映している

**今後の行動**:
- 新規プロジェクト作成時は、まず公式CLIツールの有無を確認
- `create-next-app`, `uv init`, `cargo new` など

---

### 2. コミット粒度を守る

**状況**: フロントエンド完了後、バックエンド、共通リソース、CIまで一気に進めてしまった。

**ユーザーからのフィードバック**:
> 「フロントエンドが完了した時点でコミットをすべきでした。なぜあなたはその大きい粒度で作業を進めてしまうのですか」

**学び**:
- 各フェーズ完了時点でコミットすべき
- 大きな変更を一度にコミットすると、レビューが困難になる
- 問題発生時のロールバックも難しくなる

**今後の行動**:
- tasklist.md のフェーズごとにコミット
- 「1つの論理的な変更 = 1コミット」を徹底
- フェーズ完了時に「コミットすべきか？」を自問する

---

### 3. 最新のツールチェーンを確認する

**状況**: 設計書では ESLint/Prettier を想定していたが、ユーザーは Biome を希望。

**ユーザーからのフィードバック**:
> 「リンターとフォーマッターですが、biomejs を使ってください」

**学び**:
- ツールチェーンは急速に進化する
- 設計書の内容が古くなっている可能性がある
- 実装開始前に最新のベストプラクティスを確認すべき

**今後の行動**:
- 実装開始前に、設計書のツール選定が最新かユーザーに確認
- Biome, Ruff など新しい統合ツールを優先検討
- 設計書と異なる選択をした場合は、tasklist.md に差異を記録

---

### 4. ドキュメント間の整合性を保つ

**状況**: `frontend/CLAUDE.md` を追加後、`.claude/skills/frontend/SKILL.md` との競合チェックが必要だった。

**学び**:
- 複数のドキュメントソースが存在する場合、役割分担を明確にすべき
- バージョン表記の不一致（Next.js 14+ vs 16）は混乱を招く
- 優先順位を明示することで、矛盾を防げる

**今後の行動**:
- 新しいドキュメント追加時は、既存ドキュメントとの競合をチェック
- 役割分担を明確に（APIリファレンス vs コーディング規約）
- バージョン表記は実際のバージョンと一致させる

---

### 5. 環境依存のコマンドに注意

**状況**: ユーザーが `uvicorn app.main:app` を実行したが、「command not found」エラー。

**原因**: `uv sync` は仮想環境にパッケージをインストールするが、グローバルには追加しない。

**学び**:
- Python の仮想環境では `uv run` プレフィックスが必要
- ドキュメントやREADMEには環境を考慮したコマンドを記載すべき

**今後の行動**:
- READMEやtasklist.mdには `uv run uvicorn ...` と記載
- 環境依存のコマンドには注釈を付ける

---

## 反省点

### やってしまったこと

1. **手動でディレクトリ作成を試みた** - 公式ツールを使うべきだった
2. **大きな粒度で作業を進めた** - フェーズごとにコミットすべきだった
3. **設計書のツール選定をそのまま採用** - 最新のツールチェーンを確認すべきだった
4. **Biome 2.x の設定で古い構文を使用** - `ignore` キーが無効でエラー
5. **Tailwind ディレクティブのサポート漏れ** - `tailwindDirectives: true` が必要だった

### 良かったこと

1. **ユーザーフィードバック後、即座に修正できた**
2. **tasklist.md の変更点セクションで差異を記録した**
3. **各フェーズ完了後のコミットを（指摘後）徹底した**
4. **ドキュメント競合チェックで役割分担を明確にした**
5. **SKILL.md のバージョン表記を即座に更新した**

---

## 次回への改善アクション

| 項目 | アクション |
|------|----------|
| プロジェクト初期化 | 公式CLIツールの有無を最初に確認 |
| コミット粒度 | フェーズ完了時に必ずコミット |
| ツール選定 | 設計書の内容が最新か確認 |
| 設定ファイル | ツールのバージョンに応じた構文を使用 |
| ドキュメント追加 | 既存ドキュメントとの競合チェック |

---

## 成果物

- **PR**: https://github.com/arakitakashi/homework-coach-robo/pull/1
- **コミット数**: 7
- **変更ファイル数**: 68
- **追加行数**: ~1,919行

---

## 参照

- `.steering/20260201-repository-setup/requirements.md`
- `.steering/20260201-repository-setup/design.md`
- `.steering/20260201-repository-setup/tasklist.md`
