# Requirements - Unit Test Skill

## 背景・目的

### 背景

TDD（Test-Driven Development）を採用しているプロジェクトにおいて、テスト実行時の詳細なログ出力がメインエージェントのコンテキストを汚染している。

**現状の問題:**
- REDフェーズ: テスト実行 → 数十〜数百行の失敗ログがコンテキストに載る
- GREENフェーズ: テスト実行 → 数十〜数百行の成功ログがコンテキストに載る
- 必要なのは「Pass/Fail」の結果のみで、詳細ログは不要

### 目的

テスト実行をサブエージェントに委譲し、結果サマリーのみを返却することで、メインエージェントのコンテキスト消費を削減する。

## 要求事項

### 機能要件

1. **テスト実行の委譲**
   - フロントエンド（Vitest）とバックエンド（pytest）の両方に対応
   - 特定のテストファイル、ディレクトリ、またはテスト名を指定可能
   - サブエージェントがテストコマンドを実行

2. **結果サマリーの返却**
   - Pass/Fail ステータス
   - テスト数（passed/failed/skipped）
   - 実行時間
   - 失敗時のエラーメッセージ（簡潔に）
   - **詳細なログは含めない**

3. **TDDフローへの適合**
   - REDフェーズ: テストが失敗することを確認
   - GREENフェーズ: テストが通ることを確認
   - 即座にフィードバックを得られる

### 非機能要件

1. **パフォーマンス**
   - サブエージェント起動のオーバーヘッドは許容範囲内
   - テスト実行時間 + 1〜2秒程度の待機時間

2. **使いやすさ**
   - シンプルなインターフェース
   - 環境（frontend/backend）は自動判定または明示的に指定

3. **保守性**
   - スキルファイルのみで完結
   - 既存のプロジェクト構造に影響を与えない

### 制約条件

1. **既存スキルとの棲み分け**
   - `/quality-check`: 実装完了後の全品質チェック（lint + type + test + coverage）
   - `/unit-test`: TDDサイクル中の単一テスト実行（テストのみ、サマリーのみ）

2. **対応環境**
   - フロントエンド: `bun test <path>` (Vitest)
   - バックエンド: `uv run pytest <path> -v` (pytest)

## 対象範囲

### In Scope

- ✅ フロントエンド（Vitest）のテスト実行
- ✅ バックエンド（pytest）のテスト実行
- ✅ 結果サマリーの構造化
- ✅ エラーメッセージの簡潔な抽出
- ✅ スキルファイルの作成

### Out of Scope

- ❌ カバレッジレポート（`/quality-check`の責務）
- ❌ Lint・Type Check（`/quality-check`の責務）
- ❌ E2Eテスト（別途検討）
- ❌ テスト自動修正機能

## 成功基準

1. **コンテキスト削減**
   - テスト実行ログの詳細がメインエージェントに載らない
   - 返却されるのは10行以内のサマリーのみ

2. **正確性**
   - Pass/Fail 判定が正確
   - 失敗時のエラーメッセージが適切に抽出される

3. **TDDフローの維持**
   - REDフェーズでの使用が自然
   - GREENフェーズでの使用が自然
   - 開発者の思考を中断しない

4. **ドキュメント整備**
   - スキルファイルに明確な使用方法が記載されている
   - CLAUDE.md に追加されている
