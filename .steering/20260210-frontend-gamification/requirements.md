# Requirements - フロントエンド ゲーミフィケーション要素

## 背景・目的

### 背景
Phase 2でソクラテス式対話、マルチエージェント、感情適応が完成し、学習支援の基盤は整った。しかし、低学年児童（1〜3年生）にとって「宿題をやり続ける動機付け」が課題として残っている。

### 目的
- **継続的な学習意欲の向上**: 宿題を「やらされるもの」から「やりたいもの」に転換
- **達成感の可視化**: 小さな成功体験を積み重ね、自己肯定感を育む
- **楽しさの演出**: ストーリー性のあるゲーム要素で飽きさせない

---

## 要求事項

### 機能要件

#### 1. 冒険ストーリー進行システム
- **ストーリー進行**: 問題を解くごとにストーリーが進む
- **チャプター管理**: 学年・教科ごとに異なるストーリーラインを提供
- **キャラクター成長**: ロボットキャラクターがレベルアップ・進化

#### 2. ポイント・報酬システム
- **ポイント獲得**:
  - 「自分で気づいた」→ 3ポイント（既存のLearningProgressと連携）
  - 「ヒントで気づいた」→ 2ポイント
  - 「一緒に解いた」→ 1ポイント
- **累積ポイント表示**: セッションごと・全体の累積ポイント
- **特別ボーナス**: 連続正解、初回クリアなど

#### 3. バッジ・実績システム
- **バッジ獲得条件**:
  - 「初めての問題クリア」
  - 「10問連続正解」
  - 「算数マスター（算数問題50問クリア）」
  - 「粘り強い挑戦者（ヒント3段階すべて使用して正解）」
- **バッジ表示**: コレクション画面で獲得済みバッジを確認可能

#### 4. ビジュアルフィードバック
- **アニメーション**:
  - 正解時: キラキラエフェクト、キャラクターの喜び
  - レベルアップ時: 光の演出、効果音（将来実装）
- **プログレスバー**: ストーリー進行度、レベルアップまでの進捗

### 非機能要件

#### パフォーマンス
- アニメーション遅延: 60fps以上（Framer Motion活用）
- データ取得遅延: 200ms以内

#### アクセシビリティ
- ビジュアル要素に代替テキスト（aria-label）を提供
- キーボード操作のみでバッジ画面を閲覧可能

#### セキュリティ
- ポイント操作はバックエンドで検証（フロントエンドは表示のみ）
- 不正なポイント加算を防止

### 制約条件

- **既存データモデルとの互換性**: `LearningProgress`を拡張（破壊的変更なし）
- **バックエンド未実装**: Phase 1ではフロントエンドのみ実装（モックデータ使用）
- **Phase 2連携**: 感情適応と連携（例: イライラ時はポイント減らさない）

---

## 対象範囲

### In Scope (Phase 1 - フロントエンドのみ)
- ポイント表示コンポーネント
- バッジ表示コンポーネント
- ストーリー進行UIコンポーネント
- アニメーション演出（Framer Motion）
- モックデータでの動作確認
- SessionContentへの統合

### Out of Scope (将来実装)
- バックエンドAPI（ポイント計算、バッジ判定）
- データベースへの永続化（Firestore）
- 効果音・BGM
- マルチプレイヤー機能
- 親向けの進捗レポート

---

## 成功基準

1. **ポイントがリアルタイムで表示される**
2. **バッジ獲得時にアニメーションが表示される**
3. **ストーリー進行度が視覚的にわかる**
4. **既存のSessionContentと統合され、UXが損なわれていない**
5. **テストカバレッジ80%以上を維持**
6. **Biome lint、TypeScriptチェックがすべてパス**
