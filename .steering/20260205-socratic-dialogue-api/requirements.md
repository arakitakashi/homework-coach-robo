# Requirements - ソクラテス式対話API統合

## 背景・目的

ソクラテス式対話エンジン（SocraticDialogueManager）と3段階ヒントシステムは既に実装済みです。
これらをFastAPI エンドポイントとして公開し、フロントエンドから利用可能にします。

## 要求事項

### 機能要件

#### FR-1: 対話セッション管理

| ID | 要件 |
|----|------|
| FR-1.1 | 新しい対話セッションを開始できる |
| FR-1.2 | セッション情報を取得できる |
| FR-1.3 | セッションを終了できる |
| FR-1.4 | セッションコンテキストを永続化できる |

#### FR-2: 対話エンドポイント

| ID | 要件 |
|----|------|
| FR-2.1 | 子供の回答を分析し、ResponseAnalysisを返す |
| FR-2.2 | 次の質問を生成して返す |
| FR-2.3 | 答えリクエストを検出できる |
| FR-2.4 | ヒントを段階的に提供できる |

#### FR-3: ヒントシステム統合

| ID | 要件 |
|----|------|
| FR-3.1 | 現在のヒントレベルを取得できる |
| FR-3.2 | ヒントレベルの進行を制御できる |
| FR-3.3 | レベルごとのヒントを生成できる |

### 非機能要件

| ID | 要件 | 目標値 |
|----|------|--------|
| NFR-1 | レスポンス時間（分析） | < 2秒 |
| NFR-2 | レスポンス時間（質問生成） | < 3秒 |
| NFR-3 | テストカバレッジ | >= 80% |

### 制約条件

1. **LLMクライアント**: 実際のLLM統合は後続フェーズ。今回はインターフェースのみ定義
2. **認証**: 今回のスコープ外。後続フェーズで実装
3. **永続化**: 今回はインメモリ。Firestore統合は後続フェーズ

## 対象範囲

### In Scope

- `/api/v1/dialogue/` エンドポイントの実装
- リクエスト/レスポンススキーマの定義
- サービス層とAPIの接続
- ユニットテスト・統合テスト
- OpenAPI（Swagger）ドキュメント自動生成

### Out of Scope

- 実際のLLM（Gemini）統合
- 認証・認可
- Firestore永続化
- WebSocket対応
- 音声STT/TTS統合

## 成功基準

1. すべてのエンドポイントが正常に動作する
2. OpenAPIドキュメントが自動生成される
3. テストカバレッジ80%以上
4. Ruff lint/formatがパス
