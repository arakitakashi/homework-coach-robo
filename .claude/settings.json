{
	"hooks": {
		"PostToolUse": [
			{
				"matcher": "Write|Edit|MultiEdit",
				"hooks": [
					{
						"type": "command",
						"command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/auto-format.sh",
						"timeout": 30
					}
				]
			}
		]
	},
	"defaultModel": "sonnet",
	"dangerMode": false,
	"sandbox": {
		"enabled": true,
		"autoAllowBashIfSandboxed": true,
		"excludedCommands": ["docker", "gh"],
		"allowUnsandboxedCommands": true,
		"network": {
			"allowedDomains": [
				"github.com",
				"*.github.com",
				"registry.npmjs.org",
				"*.npmjs.org",
				"registry.terraform.io",
				"*.googleapis.com",
				"pypi.org",
				"files.pythonhosted.org",
				"api.anthropic.com"
			]
		}
	},
	"commandPermissions": {
		"blocked": [
			"rm -rf /",
			"rm -rf ~",
			"rm -rf .",
			"rm -rf ./*",
			"rm -rf *",
			"> /dev/sda",
			"dd if=/dev/zero",
			"mkfs.ext4",
			":(){ :|:& };:",
			"git push --force origin main",
			"git push --force origin develop",
			"git push -f origin main",
			"git push -f origin develop",
			"git reset --hard origin/main",
			"git reset --hard origin/develop",
			"gcloud sql instances delete",
			"gcloud compute instances delete",
			"gcloud run services delete homework-coach-prod",
			"gcloud projects delete",
			"firebase firestore:delete --all-collections",
			"bq rm -r -f",
			"npm publish",
			"pypi upload"
		],
		"requireApproval": [
			"gcloud * --project=*prod*",
			"gcloud run deploy * --project=*prod*",
			"gcloud firestore * --project=*prod*",
			"firebase deploy --project *prod*",
			"bq query * DELETE",
			"bq query * DROP",
			"bq rm *",
			"git push * main",
			"git push * develop",
			"git merge main",
			"git merge develop",
			"npm install --save *",
			"pip install *",
			"docker run --privileged",
			"chmod 777 *",
			"sudo *",
			"curl * | bash",
			"curl * | sh",
			"wget * -O- | bash"
		],
		"autoApprove": [
			"git status*",
			"git diff*",
			"git log*",
			"git branch*",
			"git show*",
			"npm test*",
			"npm run test*",
			"npm run lint*",
			"pytest*",
			"python -m pytest*",
			"uv run pytest*",
			"uv run ruff*",
			"uv run mypy*",
			"uv sync*",
			"bun test*",
			"vitest*",
			"git checkout -b feature/*",
			"git checkout -b fix/*",
			"git checkout -b refactor/*",
			"git checkout -b docs/*",
			"git checkout -b hotfix/*",
			"git checkout -b chore/*",
			"git add *",
			"git commit *",
			"git push *",
			"gh pr create *",
			"gh pr view *",
			"gh pr list *",
			"echo *",
			"cat *",
			"ls *",
			"pwd",
			"find *",
			"grep *",
			"sed *",
			"awk *",
			"touch *",
			"mkdir *",
			"cp * *",
			"mv * *"
		]
	},
	"requireApprovalPatterns": [
		"gcloud.*prod",
		"firebase.*prod",
		"DROP\\s+(TABLE|DATABASE|SCHEMA)",
		"DELETE\\s+FROM.*WHERE\\s+1=1",
		"TRUNCATE\\s+TABLE",
		"ALTER\\s+TABLE.*DROP",
		"rm\\s+-rf?\\s+/",
		"rm\\s+-rf?\\s+\\$HOME",
		"git\\s+push.*--force",
		"git\\s+push.*-f\\s"
	],
	"customInstructions": "# Autonomous Workflow with Steering Mode\n\n## ğŸš¨ CRITICAL: Commit Granularity Rules\n\n**1ã‚¿ã‚¹ã‚¯ = 1ã‚³ãƒŸãƒƒãƒˆ** ã‚’å³å®ˆã™ã‚‹ã“ã¨ã€‚\n\n### ã‚³ãƒŸãƒƒãƒˆã™ã¹ãã‚¿ã‚¤ãƒŸãƒ³ã‚°\n\nä»¥ä¸‹ã®å„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å¿…ãšã‚³ãƒŸãƒƒãƒˆã™ã‚‹:\n\n1. **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª/ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆå¾Œ**: æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚„__init__.pyã‚’ä½œæˆã—ãŸã‚‰å³ã‚³ãƒŸãƒƒãƒˆ\n2. **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆå¾Œï¼ˆRedï¼‰**: å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‚‰ã‚³ãƒŸãƒƒãƒˆ\n3. **å®Ÿè£…å®Œäº†å¾Œï¼ˆGreenï¼‰**: ãƒ†ã‚¹ãƒˆãŒé€šã‚‹æœ€å°é™ã®å®Ÿè£…ã‚’æ›¸ã„ãŸã‚‰ã‚³ãƒŸãƒƒãƒˆ\n4. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œï¼ˆRefactorï¼‰**: ã‚³ãƒ¼ãƒ‰æ”¹å–„ã—ãŸã‚‰ã‚³ãƒŸãƒƒãƒˆ\n5. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´å¾Œ**: pyproject.tomlã€tsconfig.jsonç­‰ã‚’å¤‰æ›´ã—ãŸã‚‰ã‚³ãƒŸãƒƒãƒˆ\n6. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°å¾Œ**: READMEã€CLAUDE.mdã€ã‚¹ã‚­ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ç­‰ã‚’æ›´æ–°ã—ãŸã‚‰ã‚³ãƒŸãƒƒãƒˆ\n\n### ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹\n\n```\ntest(dialogue): QuestionType Enumã®ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ \nfeat(dialogue): QuestionType Enumã‚’å®Ÿè£…\nrefactor(dialogue): QuestionTypeã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ”¹å–„\nchore: dialogue moduleã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ä½œæˆ\ndocs(skills): ADKã‚¹ã‚­ãƒ«ã‚’v2.0ã«æ›´æ–°\n```\n\n### ç¦æ­¢äº‹é …\n\n- è¤‡æ•°ã®æ©Ÿèƒ½/å¤‰æ›´ã‚’1ã¤ã®ã‚³ãƒŸãƒƒãƒˆã«ã¾ã¨ã‚ãªã„\n- ãƒ†ã‚¹ãƒˆã¨å®Ÿè£…ã‚’åŒã˜ã‚³ãƒŸãƒƒãƒˆã«ã—ãªã„\n- ã€Œå¾Œã§ã¾ã¨ã‚ã¦ã‚³ãƒŸãƒƒãƒˆã€ã¯ç¦æ­¢\n\n---\n\n## MANDATORY: Steering Workflow for ALL Implementation Tasks\n\nWhen the user requests ANY implementation task (feature, bug fix, refactoring, etc.), you MUST follow this complete workflow:\n\n### Phase 0: Steering Directory Setup (ALWAYS REQUIRED)\n\n1. **Create Steering Directory**:\n   ```bash\n   mkdir -p .steering/$(date +%Y%m%d)-<work-description>\n   ```\n   - Use kebab-case for work-description\n   - Examples: `add-email-validation`, `fix-authentication-bug`, `refactor-api-layer`\n\n2. **Copy Templates and Create Documents** (in this order):\n   a. **requirements.md**: Define what and why\n      - Background and purpose\n      - Functional requirements\n      - Non-functional requirements\n      - Constraints\n      - Success criteria\n   \n   b. **design.md**: Define how\n      - Architecture overview\n      - Technology selection\n      - Data design\n      - API design (if applicable)\n      - File structure\n      - Dependencies\n      - Error handling\n      - Security considerations\n      - Performance considerations\n      - Alternative approaches and rationale\n   \n   c. **tasklist.md**: Break down into tasks\n      - Phase 1: Environment setup\n      - Phase 2: Test implementation (TDD)\n      - Phase 3: Implementation\n      - Phase 4: Integration tests\n      - Phase 5: Quality checks\n      - Phase 6: Deploy preparation (if applicable)\n\n3. **Get User Approval**: Show user the three documents and confirm before proceeding\n\n### Phase 1: Branch Creation\n\n- Create branch following Git Flow conventions:\n  - `feature/<scope>-<description>` for new features\n  - `fix/<scope>-<description>` for bug fixes\n  - `refactor/<scope>-<description>` for refactoring\n- Use kebab-case for branch names\n- Check out from `develop` branch (not `main`)\n- Use `/git-workflow` skill for conventions\n\n### Phase 2: Environment Setup\n\n- Follow tasklist.md Phase 1\n- Install dependencies\n- Configure environment variables\n- Create necessary directories\n\n### Phase 3: TDD Implementation\n\n- Follow tasklist.md Phase 2-4\n- ALWAYS write tests BEFORE implementation code\n- Follow Red-Green-Refactor cycle with COMMITS:\n  1. Red: Write failing test â†’ **COMMIT**\n  2. Green: Write minimal code to pass â†’ **COMMIT**\n  3. Refactor: Improve code quality â†’ **COMMIT**\n- **Each cycle produces 2-3 commits minimum**\n- Use `/tdd` skill for TDD best practices\n- Use appropriate skills:\n  - `/frontend` for UI components\n  - `/fastapi` for backend APIs\n  - `/google-adk-live` for voice interaction features\n- Update tasklist.md with [x] as tasks complete\n- Use TodoWrite tool to track progress\n\n### Phase 4: Quality Assurance\n\n- Follow tasklist.md Phase 5\n- Run all tests and ensure 80%+ coverage\n- Run linters and formatters:\n  - Frontend: `bun run lint`\n  - Backend: `ruff check` + `mypy`\n- Security review using `/security-review` skill:\n  - OWASP Top 10 checks\n  - Input validation\n  - Authentication & authorization\n- Verify CLAUDE.md and docs/ compliance\n\n### Phase 5: PR Creation\n\n- Push branch: `git push -u origin HEAD`\n- Create PR with Conventional Commits format:\n  - Title: `<type>(<scope>): <description>`\n  - Types: feat, fix, refactor, test, docs, perf, build, ci, chore\n- Include comprehensive PR description:\n  - Summary of changes\n  - Test plan\n  - Breaking changes (if any)\n  - Related issues\n- Use `/git-workflow` for PR template\n\n### Phase 6: Completion Documentation\n\n- Create `COMPLETED.md` in steering directory:\n  - Summary of implementation\n  - Changed files\n  - Problems encountered and solutions\n  - Test results\n  - Quality check results\n  - Future improvements\n  - Lessons learned\n- Report completion with PR URL\n\n## When to Ask User Confirmation\n\n### ASK Before Proceeding:\n- After creating steering documents (requirements.md, design.md, tasklist.md)\n- Architectural decisions (if multiple valid approaches exist)\n- Security-related implementations (if novel approach needed)\n- Breaking changes\n- Scope clarifications (if requirements are unclear)\n\n### PROCEED Autonomously:\n- Steering directory and document creation\n- File creation/editing\n- Test writing and execution\n- Code refactoring\n- Documentation updates\n- Branch creation and commits\n- PR creation (after implementation is complete)\n- COMPLETED.md creation\n\n## Complete Workflow Example\n\nUser: \"Add email validation to the user registration form\"\n\nYou MUST:\n1. Create `.steering/20260131-add-email-validation/`\n2. Create requirements.md (what: email validation, why: data integrity)\n3. Create design.md (how: Zod schema, where: registration form component)\n4. Create tasklist.md (break into 6 phases)\n5. Get user approval\n6. Create branch: `feature/frontend-email-validation`\n7. Follow tasklist.md Phase 1 (environment setup)\n8. Follow tasklist.md Phase 2-4 (TDD implementation)\n   - Write test for email validation (Red) â†’ **COMMIT**: `test(auth): Add email validation test`\n   - Implement validation logic (Green) â†’ **COMMIT**: `feat(auth): Implement email validation`\n   - Refactor if needed â†’ **COMMIT**: `refactor(auth): Extract validation utils`\n   - Update tasklist.md with [x]\n9. Follow tasklist.md Phase 5 (quality checks)\n   - Run tests, ensure 80%+ coverage\n   - Security check (XSS, injection prevention)\n   - Lint and format\n10. (Commits already done in step 8 - no big commit at end)\n11. Push and create PR\n12. Create COMPLETED.md\n13. Report completion with PR URL\n\n## Important Notes\n\n- NEVER skip steering directory setup - it's mandatory for ALL tasks\n- Complete the ENTIRE workflow unless user stops you\n- Use TodoWrite to track progress throughout\n- Update tasklist.md in real-time as tasks complete\n- Report blockers immediately\n- Maintain high code quality - never skip tests or security checks\n- Follow all guidelines in CLAUDE.md, docs/, and .claude/rules/\n- See `.claude/rules/steering-workflow.md` for detailed workflow documentation",
	"mcpServers": {
		"context7": {
			"command": "npx",
			"args": [
				"-y",
				"@upthink/mcp-context7@latest"
			]
		},
		"playwright": {
			"command": "npx",
			"args": [
				"-y",
				"@upthink/mcp-playwright@latest"
			]
		}
	}
}
